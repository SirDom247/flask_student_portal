<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Professional Diploma in Education - Student Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ“</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Mobile-first responsive utilities */
        .mobile-container { @apply w-full px-4 mx-auto; }
        
        /* Mobile menu animations */
        .mobile-menu-enter {
            transform: translateY(-100%);
            opacity: 0;
        }
        .mobile-menu-enter-active {
            transform: translateY(0);
            opacity: 1;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        .mobile-menu-exit {
            transform: translateY(0);
            opacity: 1;
        }
        .mobile-menu-exit-active {
            transform: translateY(-100%);
            opacity: 0;
            transition: transform 0.3s ease-in, opacity 0.3s ease-in;
        }
        
        /* Card hover effects for larger screens */
        @media (min-width: 768px) {
            .card-hover:hover { 
                transform: translateY(-4px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            }
        }
        
        /* Table responsive styles */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Print styles */
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; color: black !important; }
            .print-full-width { width: 100% !important; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-slate-900 to-black min-h-screen flex flex-col text-white">

    <!-- Mobile-First Navigation -->
    <nav class="bg-gradient-to-r from-gray-800 to-gray-900 text-white px-4 py-3 sticky top-0 z-40 border-b border-gray-700">
        <div class="flex items-center justify-between">
            <!-- Logo and Title -->
            <div class="flex items-center space-x-3">
                <img src="{{ url_for('static', filename='images/fcetomoku-logo-2.jpg') }}"
                     alt="FCET Omoku Logo"
                     class="w-8 h-8 rounded-full object-cover"
                     onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23374151%22/><text x=%2250%22 y=%2250%22 font-size=%2220%22 text-anchor=%22middle%22 alignment-baseline=%22middle%22 fill=%22%2310b981%22>ðŸŽ“</text></svg>';">
                <span class="font-bold text-lg bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent">FCE(T) OMOKU</span>
            </div>

            <!-- Mobile Menu Button -->
            <button id="mobileMenuButton" class="p-2 rounded-lg bg-gray-700 text-green-400">
                <svg id="menuIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden">
        <div class="bg-gray-900 h-full overflow-y-auto">
            <div class="p-4 border-b border-gray-700 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <img src="{{ url_for('static', filename='images/fcetomoku-logo-2.jpg') }}"
                         alt="FCET Omoku Logo"
                         class="w-8 h-8 rounded-full object-cover">
                    <span class="font-bold text-lg text-white">Student Portal</span>
                </div>
                <button id="closeMenuButton" class="p-2 text-gray-400">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="p-4">
                {% if current_user.is_authenticated %}
                    <!-- User Info -->
                    <div class="bg-gray-800 rounded-xl p-4 mb-6">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center">
                                {% if current_user.profile_picture %}
                                    <img src="{{ current_user.profile_picture }}" alt="Profile" class="w-full h-full object-cover rounded-full">
                                {% else %}
                                    <i class="fas fa-user text-white"></i>
                                {% endif %}
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white">{{ current_user.full_name }}</h3>
                                <p class="text-gray-400 text-sm">{{ current_user.matric_no }}</p>
                                <p class="text-green-400 text-xs">
                                    {% if current_user.role == 'student' %}
                                        <i class="fas fa-user-graduate mr-1"></i>Student
                                    {% else %}
                                        <i class="fas fa-user-tie mr-1"></i>Officer
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-envelope mr-3 text-green-400 w-4"></i>
                                <span class="truncate">{{ current_user.email }}</span>
                            </div>
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-building mr-3 text-blue-400 w-4"></i>
                                <span>{{ current_user.department }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Links -->
                    <div class="space-y-2">
                        {% if current_user.role == 'student' %}
                            <a href="{{ url_for('dashboard_student') }}" class="flex items-center p-3 bg-gray-800 rounded-lg text-white">
                                <i class="fas fa-tachometer-alt mr-3 text-green-400"></i>
                                Student Dashboard
                            </a>
                        {% elif current_user.role == 'officer' %}
                            <a href="{{ url_for('dashboard_officer') }}" class="flex items-center p-3 bg-gray-800 rounded-lg text-white">
                                <i class="fas fa-tachometer-alt mr-3 text-green-400"></i>
                                Officer Dashboard
                            </a>
                            
                            <!-- Officer Submenu -->
                            <div class="ml-4 space-y-2 mt-2">
                                <a href="{{ url_for('search_students') }}" class="flex items-center p-3 bg-gray-700 rounded-lg text-gray-300">
                                    <i class="fas fa-users mr-3 text-blue-400"></i>
                                    Search Students
                                </a>
                                <a href="{{ url_for('search_results') }}" class="flex items-center p-3 bg-gray-700 rounded-lg text-gray-300">
                                    <i class="fas fa-chart-bar mr-3 text-purple-400"></i>
                                    Search Results
                                </a>
                                <a href="{{ url_for('bulk_actions_dashboard') }}" class="flex items-center p-3 bg-gray-700 rounded-lg text-red-400">
                                    <i class="fas fa-trash-alt mr-3"></i>
                                    Bulk Actions
                                </a>
                            </div>
                        {% endif %}

                        <button onclick="openChangePasswordModal()" class="w-full text-left flex items-center p-3 bg-gray-800 rounded-lg text-white">
                            <i class="fas fa-key mr-3 text-yellow-400"></i>
                            Change Password
                        </button>

                        <a href="{{ url_for('logout') }}" class="flex items-center p-3 bg-gray-800 rounded-lg text-red-400 border-t border-gray-700 mt-4">
                            <i class="fas fa-sign-out-alt mr-3"></i>
                            Logout
                        </a>
                    </div>
                {% else %}
                    <!-- Guest Navigation -->
                    <div class="space-y-3">
                        <a href="{{ url_for('home') }}" class="flex items-center p-3 bg-gray-800 rounded-lg text-emerald-400">
                            <i class="fas fa-home mr-3"></i>
                            Home
                        </a>
                        <a href="{{ url_for('login') }}" class="flex items-center p-3 bg-gray-800 rounded-lg text-emerald-400">
                            <i class="fas fa-sign-in-alt mr-3"></i>
                            Login
                        </a>
                        <a href="{{ url_for('register') }}" class="flex items-center p-3 bg-green-600 rounded-lg text-white justify-center font-semibold">
                            <i class="fas fa-user-plus mr-3"></i>
                            Register
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-1 mobile-container py-4">
        <!-- Flash Messages -->
        <div id="flash-messages" class="mb-4 space-y-2">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flex items-center space-x-3 p-4 rounded-xl border flash
                            {% if category == 'success' %}bg-green-900 bg-opacity-20 text-green-400 border-green-800
                            {% elif category == 'danger' %}bg-red-900 bg-opacity-20 text-red-400 border-red-800
                            {% else %}bg-gray-800 bg-opacity-50 text-gray-300 border-gray-700{% endif %}">
                            <div class="flex-shrink-0">
                                {% if category == 'success' %}
                                    <i class="fas fa-check-circle text-green-400"></i>
                                {% elif category == 'danger' %}
                                    <i class="fas fa-exclamation-circle text-red-400"></i>
                                {% else %}
                                    <i class="fas fa-info-circle text-gray-400"></i>
                                {% endif %}
                            </div>
                            <span class="flex-1 font-medium text-sm">{{ message }}</span>
                            <button onclick="this.parentElement.remove()" class="text-gray-500 hover:text-gray-300">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>

        <!-- Welcome Header -->
        <div class="mb-6">
            <div class="flex flex-col space-y-4">
                <div>
                    <h1 class="text-2xl font-bold text-white">Welcome ðŸ‘‹</h1>
                    <h2 class="text-3xl font-bold text-green-400">{{ current_user.full_name }}</h2>
                </div>
                <div class="bg-gradient-to-r from-green-600 to-emerald-700 text-white px-4 py-3 rounded-xl font-semibold self-start">
                    <i class="fas fa-id-card mr-2"></i>Matric: {{ current_user.matric_no }}
                </div>
            </div>
        </div>

        <!-- Profile and Stats Section -->
        <div class="space-y-6 mb-6">
            <!-- Profile Card -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 border border-gray-700 card-hover transition-all duration-300">
                <div class="text-center">
                    <!-- Profile Photo -->
                    <div class="relative inline-block mb-4 group">
                        <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto border-4 border-gray-700 overflow-hidden cursor-pointer"
                             onclick="openPhotoOptions()">
                            {% if current_user.profile_picture %}
                                <img src="{{ current_user.profile_picture }}" alt="Profile" class="w-full h-full object-cover">
                            {% else %}
                                <i class="fas fa-user-graduate text-white text-xl"></i>
                            {% endif %}
                            
                            <!-- Hover Overlay -->
                            <div class="absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <i class="fas fa-camera text-white"></i>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-bold text-white mb-1">{{ current_user.full_name }}</h3>
                    <p class="text-gray-400 text-sm mb-4">{{ current_user.matric_no }}</p>
                    
                    <div class="space-y-2 text-left">
                        <div class="flex items-center text-gray-300 text-sm">
                            <i class="fas fa-envelope mr-3 text-green-400 w-4"></i>
                            <span class="truncate">{{ current_user.email }}</span>
                        </div>
                        <div class="flex items-center text-gray-300 text-sm">
                            <i class="fas fa-user mr-3 text-blue-400 w-4"></i>
                            <span>{{ current_user.username }}</span>
                        </div>
                        <div class="flex items-center text-gray-300 text-sm">
                            <i class="fas fa-building mr-3 text-yellow-400 w-4"></i>
                            <span>{{ current_user.department }}</span>
                        </div>
                        {% if current_user.school %}
                        <div class="flex items-center text-gray-300 text-sm">
                            <i class="fas fa-university mr-3 text-purple-400 w-4"></i>
                            <span>{{ current_user.school }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 gap-4">
                <!-- CGPA Card -->
                <div class="bg-gradient-to-br from-green-900 to-emerald-800 rounded-2xl p-5 border border-green-700 card-hover transition-all duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-green-200 text-sm">Current CGPA</p>
                            <p class="text-3xl font-bold text-white">
                                {% if results and results[0].semester_cgpa %}
                                    {{ "%.2f"|format(results[0].semester_cgpa) }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </p>
                        </div>
                        <div class="w-10 h-10 bg-green-500 bg-opacity-30 rounded-xl flex items-center justify-center">
                            <i class="fas fa-star text-green-300"></i>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs">
                            <span class="text-green-200">Academic Standing</span>
                            <span class="text-white font-medium">
                                {% if results and results[0].semester_cgpa %}
                                    {% if results[0].semester_cgpa >= 4.5 %}
                                        1<sup>st</sup> Class
                                    {% elif results[0].semester_cgpa >= 3.5 %}
                                        2<sup>nd</sup> Class Upper
                                    {% elif results[0].semester_cgpa >= 2.5 %}
                                        2<sup>nd</sup> Class Lower
                                    {% elif results[0].semester_cgpa >= 1.5 %}
                                        3<sup>rd</sup> Class
                                    {% else %}
                                        Pass
                                    {% endif %}
                                {% else %}
                                    N/A
                                {% endif %}
                            </span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="text-green-200">Max CGPA</span>
                            <span class="text-white font-medium">5.00</span>
                        </div>
                    </div>
                </div>

                <!-- Courses Card -->
                <div class="bg-gradient-to-br from-blue-900 to-blue-800 rounded-2xl p-5 border border-blue-700 card-hover transition-all duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-blue-200 text-sm">Courses Taken</p>
                            <p class="text-3xl font-bold text-white">
                                {% if results_pagination %}
                                    {{ results_pagination.total }}
                                {% else %}
                                    {{ results|length if results else 0 }}
                                {% endif %}
                            </p>
                        </div>
                        <div class="w-10 h-10 bg-blue-500 bg-opacity-30 rounded-xl flex items-center justify-center">
                            <i class="fas fa-book text-blue-300"></i>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs">
                            <span class="text-blue-200">Total Credits</span>
                            <span class="text-white font-medium">
                                {% if results %}
                                    {{ results|sum(attribute='credit_unit') }}
                                {% else %}
                                    0
                                {% endif %}
                            </span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="text-blue-200">Current Level</span>
                            <span class="text-white font-medium">
                                {% if results %}
                                    {{ (results|length / 10 + 100)|int }} Level
                                {% else %}
                                    100 Level
                                {% endif %}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Performance Card -->
                <div class="bg-gradient-to-br from-purple-900 to-purple-800 rounded-2xl p-5 border border-purple-700 card-hover transition-all duration-300">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-purple-200 text-sm">Average Score</p>
                            <p class="text-3xl font-bold text-white">
                                {% if results and average_score is defined and average_score > 0 %}
                                    {{ "%.1f"|format(average_score) }}%
                                {% else %}
                                    N/A
                                {% endif %}
                            </p>
                        </div>
                        <div class="w-10 h-10 bg-purple-500 bg-opacity-30 rounded-xl flex items-center justify-center">
                            <i class="fas fa-chart-line text-purple-300"></i>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs">
                            <span class="text-purple-200">Pass Rate</span>
                            <span class="text-white font-medium">
                                {% if results %}
                                    {% set passed = results|selectattr('score', '>=', 40)|list|length %}
                                    {% set total = results|length %}
                                    {{ (passed / total * 100)|round(1) if total > 0 else 0 }}%
                                {% else %}
                                    N/A
                                {% endif %}
                            </span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="text-purple-200">Performance</span>
                            <span class="text-white font-medium">
                                {% if results and average_score is defined and average_score > 0 %}
                                    {% if average_score >= 70 %}
                                        <i class="fas fa-arrow-up text-green-400"></i> Excellent
                                    {% elif average_score >= 50 %}
                                        <i class="fas fa-minus text-yellow-400"></i> Good
                                    {% else %}
                                        <i class="fas fa-arrow-down text-red-400"></i> Needs Improvement
                                    {% endif %}
                                {% else %}
                                    N/A
                                {% endif %}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="mb-6">
            <div class="text-center mb-4">
                <h3 class="text-base font-semibold text-gray-300 flex items-center justify-center">
                    <i class="fas fa-download mr-2 text-green-400"></i>
                    Export & Print Results
                </h3>
            </div>
            <div class="flex flex-col gap-3">
                <button onclick="downloadResultsPDF()" 
                        class="group bg-gradient-to-r from-green-600 to-emerald-700 text-white p-3 rounded-xl font-semibold flex items-center justify-center border border-green-500">
                    <i class="fas fa-file-pdf mr-2"></i>
                    Download PDF
                </button>
                <button onclick="printResults()" 
                        class="group bg-gradient-to-r from-blue-600 to-blue-700 text-white p-3 rounded-xl font-semibold flex items-center justify-center border border-blue-500">
                    <i class="fas fa-print mr-2"></i>
                    Print Results
                </button>
            </div>
        </div>

        <!-- Results Table -->
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl border border-gray-700 mb-6 card-hover transition-all duration-300">
            <div class="p-4 border-b border-gray-700">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-bold text-white flex items-center">
                        <i class="fas fa-chart-bar text-green-400 mr-2"></i>
                        Examination Results
                    </h2>
                    <span class="bg-green-500 bg-opacity-20 text-green-400 px-2 py-1 rounded-full text-xs font-medium">
                        {% if results_pagination %}
                            {{ results_pagination.total }} results
                        {% else %}
                            {{ results|length }} results
                        {% endif %}
                    </span>
                </div>
            </div>

            <!-- Results count and per page selector -->
            {% if results_pagination %}
            <div class="flex items-center justify-between p-4 border-b border-gray-700">
                <div class="flex items-center space-x-2">
                    <span class="text-gray-400 text-xs">Per page:</span>
                    <select onchange="updatePerPage(this.value)" 
                            class="bg-gray-700 border border-gray-600 rounded-lg px-2 py-1 text-white text-xs focus:outline-none focus:ring-1 focus:ring-green-500">
                        <option value="5" {% if per_page == 5 %}selected{% endif %}>5</option>
                        <option value="10" {% if per_page == 10 %}selected{% endif %}>10</option>
                        <option value="20" {% if per_page == 20 %}selected{% endif %}>20</option>
                    </select>
                </div>
                <div class="text-gray-400 text-xs">
                    {{ results_pagination.first }}-{{ results_pagination.last }} of {{ results_pagination.total }}
                </div>
            </div>
            {% endif %}

            <div class="table-responsive">
                <table class="w-full text-white text-sm">
                    <thead>
                        <tr class="border-b border-gray-700">
                            <th class="py-3 px-3 text-left font-semibold text-gray-300 cursor-pointer" onclick="sortTable(0)">
                                <div class="flex items-center justify-between">
                                    <span>Course</span>
                                    <i class="fas fa-sort text-gray-400 ml-1 text-xs"></i>
                                </div>
                            </th>
                            <th class="py-3 px-3 text-left font-semibold text-gray-300 cursor-pointer" onclick="sortTable(3)">
                                <div class="flex items-center justify-between">
                                    <span>Score</span>
                                    <i class="fas fa-sort text-gray-400 ml-1 text-xs"></i>
                                </div>
                            </th>
                            <th class="py-3 px-3 text-left font-semibold text-gray-300 cursor-pointer" onclick="sortTable(4)">
                                <div class="flex items-center justify-between">
                                    <span>Grade</span>
                                    <i class="fas fa-sort text-gray-400 ml-1 text-xs"></i>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if results %}
                            {% for r in results %}
                            <tr class="border-b border-gray-700">
                                <td class="py-3 px-3">
                                    <div class="font-mono text-green-300 text-xs">{{ r.course_code }}</div>
                                    <div class="text-gray-300 text-xs truncate max-w-[120px]">{{ r.course_title }}</div>
                                    <div class="mt-1">
                                        <span class="px-1.5 py-0.5 bg-blue-500 bg-opacity-20 text-blue-400 rounded text-xs">
                                            {{ r.credit_unit }} Cr
                                        </span>
                                    </div>
                                </td>
                                <td class="py-3 px-3">
                                    <span class="px-2 py-1 rounded-full text-xs font-medium {% if r.score >= 50 %}bg-green-500 bg-opacity-20 text-green-400{% else %}bg-red-500 bg-opacity-20 text-red-400{% endif %}">
                                        {{ r.score }}
                                    </span>
                                </td>
                                <td class="py-3 px-3">
                                    {% set grade_color = {
                                        'A': 'bg-green-500 bg-opacity-20 text-green-400',
                                        'B': 'bg-blue-500 bg-opacity-20 text-blue-400',
                                        'C': 'bg-purple-500 bg-opacity-20 text-purple-400',
                                        'D': 'bg-pink-500 bg-opacity-20 text-pink-400',
                                        'E': 'bg-yellow-500 bg-opacity-20 text-yellow-400',
                                        'F': 'bg-red-500 bg-opacity-20 text-red-400'
                                    } %}
                                    <span class="px-2 py-1 rounded-full text-xs font-medium {{ grade_color.get(r.grade, 'bg-gray-500 bg-opacity-20 text-gray-400') }}">
                                        {{ r.grade }}
                                    </span>
                                    <div class="mt-1 text-xs text-gray-400">{{ r.remark }}</div>
                                </td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="3" class="py-6 text-center text-gray-400">
                                    <i class="fas fa-inbox text-xl mb-2 opacity-50"></i>
                                    <p class="text-sm">No results available yet.</p>
                                </td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>

            <!-- Results Pagination -->
            {% if results_pagination and results_pagination.pages > 1 %}
            <div class="mt-4 flex items-center justify-between border-t border-gray-700 pt-4 p-4">
                <div class="text-gray-400 text-xs">
                    {{ results_pagination.first }}-{{ results_pagination.last }} of {{ results_pagination.total }}
                </div>
                <div class="flex items-center space-x-1">
                    <!-- Previous Button -->
                    {% if results_pagination.has_prev %}
                    <a href="{{ build_pagination_url(results_pagination.prev_num, per_page) }}" 
                       class="flex items-center px-3 py-1 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-600 transition-all duration-300 text-xs">
                        <i class="fas fa-chevron-left mr-1 text-xs"></i>
                        Prev
                    </a>
                    {% else %}
                    <span class="flex items-center px-3 py-1 bg-gray-800 border border-gray-700 rounded-lg text-gray-500 cursor-not-allowed text-xs">
                        <i class="fas fa-chevron-left mr-1 text-xs"></i>
                        Prev
                    </span>
                    {% endif %}

                    <!-- Page Numbers -->
                    <div class="flex items-center space-x-1">
                        {% for page_num in results_pagination.iter_pages(left_edge=1, left_current=1, right_current=1, right_edge=1) %}
                            {% if page_num %}
                                {% if page_num == results_pagination.page %}
                                <span class="px-2 py-1 bg-green-600 text-white rounded-lg text-xs font-medium">
                                    {{ page_num }}
                                </span>
                                {% else %}
                                <a href="{{ build_pagination_url(page_num, per_page) }}" 
                                   class="px-2 py-1 bg-gray-700 text-gray-300 rounded-lg text-xs hover:bg-gray-600 transition-all duration-300">
                                    {{ page_num }}
                                </a>
                                {% endif %}
                            {% else %}
                                <span class="px-1 text-gray-500">...</span>
                            {% endif %}
                        {% endfor %}
                    </div>

                    <!-- Next Button -->
                    {% if results_pagination.has_next %}
                    <a href="{{ build_pagination_url(results_pagination.next_num, per_page) }}" 
                       class="flex items-center px-3 py-1 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-600 transition-all duration-300 text-xs">
                        Next
                        <i class="fas fa-chevron-right ml-1 text-xs"></i>
                    </a>
                    {% else %}
                    <span class="flex items-center px-3 py-1 bg-gray-800 border border-gray-700 rounded-lg text-gray-500 cursor-not-allowed text-xs">
                        Next
                        <i class="fas fa-chevron-right ml-1 text-xs"></i>
                    </span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Charts and Analytics -->
        <div class="space-y-6">
            <!-- Grade Distribution Chart -->
            {% if results %}
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 border border-gray-700 card-hover transition-all duration-300">
                <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                    <i class="fas fa-chart-pie text-blue-400 mr-2"></i>
                    Grade Distribution
                </h3>
                <div class="h-48">
                    <canvas id="gradeChart"></canvas>
                </div>
            </div>
            {% endif %}

            <!-- Performance Summary -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 border border-gray-700 card-hover transition-all duration-300">
                <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                    <i class="fas fa-tachometer-alt text-green-400 mr-2"></i>
                    Performance Summary
                </h3>
                <div class="space-y-4">
                    {% if results %}
                        {% set passed = results|selectattr('score', '>=', 40)|list|length %}
                        {% set total = results|length %}
                        {% set pass_rate = (passed / total * 100)|round(1) if total > 0 else 0 %}
                        
                        <div>
                            <div class="flex justify-between mb-2 text-sm">
                                <span class="text-gray-300">Overall Pass Rate</span>
                                <span class="text-green-400 font-bold">{{ pass_rate }}%</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: {{ pass_rate }}%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="text-xl font-bold text-green-400">{{ passed }}</div>
                                <div class="text-gray-400 text-xs">Passed</div>
                            </div>
                            <div>
                                <div class="text-xl font-bold text-red-400">{{ total - passed }}</div>
                                <div class="text-gray-400 text-xs">Need Improvement</div>
                            </div>
                        </div>
                    {% else %}
                        <div class="text-center text-gray-400 py-4">
                            <i class="fas fa-chart-bar text-xl mb-2 opacity-50"></i>
                            <p class="text-sm">No performance data available</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 border border-gray-700 card-hover transition-all duration-300">
                <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                    <i class="fas fa-bolt text-yellow-400 mr-2"></i>
                    Quick Actions
                </h3>
                <div class="space-y-3">
                    <button onclick="viewAcademicCalendar()" 
                            class="w-full text-left p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-all duration-300 flex items-center justify-between group text-sm">
                        <span class="flex items-center">
                            <i class="fas fa-calendar-alt text-blue-400 mr-3"></i>
                            Academic Calendar
                        </span>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-blue-400 transition-colors text-xs"></i>
                    </button>
                    
                    <button onclick="viewCourseMaterials()" 
                            class="w-full text-left p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-all duration-300 flex items-center justify-between group text-sm">
                        <span class="flex items-center">
                            <i class="fas fa-book text-green-400 mr-3"></i>
                            Course Materials
                        </span>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-green-400 transition-colors text-xs"></i>
                    </button>
                    
                    <button onclick="contactAdvisor()" 
                            class="w-full text-left p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-all duration-300 flex items-center justify-between group text-sm">
                        <span class="flex items-center">
                            <i class="fas fa-user-tie text-purple-400 mr-3"></i>
                            Contact Advisor
                        </span>
                        <i class="fas fa-chevron-right text-gray-400 group-hover:text-purple-400 transition-colors text-xs"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-800 py-8 bg-gradient-to-b from-gray-900 to-black mt-8">
        <div class="mobile-container">
            <div class="grid grid-cols-1 gap-8">
                <!-- Institution Info -->
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-white text-sm"></i>
                        </div>
                        <span class="text-lg font-bold text-white">PDE Portal</span>
                    </div>
                    <p class="text-gray-400 text-sm">
                        Professional Diploma in Education Program<br>
                        School of Education<br>
                        Federal College of Education Technical, Omoku
                    </p>
                </div>

                <!-- Academic Resources -->
                <div>
                    <h4 class="text-white font-semibold mb-4">Academic Resources</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li>
                            <a href="#" class="hover:text-green-400 transition-colors flex items-center space-x-2">
                                <i class="fas fa-book w-4"></i><span>Course Materials</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="hover:text-green-400 transition-colors flex items-center space-x-2">
                                <i class="fas fa-laptop w-4"></i><span>eLearning Portal</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Student Support -->
                <div>
                    <h4 class="text-white font-semibold mb-4">Student Support</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li>
                            <a href="#" class="hover:text-green-400 transition-colors flex items-center space-x-2">
                                <i class="fas fa-chart-bar w-4"></i><span>Results Portal</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="hover:text-green-400 transition-colors flex items-center space-x-2">
                                <i class="fas fa-calendar-alt w-4"></i><span>Exam Schedule</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-emerald-500 text-sm">
                <p>&copy; 2025 Federal College of Education Technical, Omoku.</p>
                <p class="mt-2 text-white">Powered by <span class="text-blue-400">Rigel IT Consultz</span></p>
            </div>
        </div>
    </footer>

    <!-- Modals (Password, Photo, etc.) -->
    <!-- These would be included here but shortened for brevity -->

    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Mobile menu functionality
        document.getElementById('mobileMenuButton').addEventListener('click', function() {
            document.getElementById('mobileMenuOverlay').classList.remove('hidden');
        });

        document.getElementById('closeMenuButton').addEventListener('click', function() {
            document.getElementById('mobileMenuOverlay').classList.add('hidden');
        });

        // Close menu when clicking outside content
        document.getElementById('mobileMenuOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
            }
        });

        // Auto-hide flash messages
        setTimeout(() => {
            document.querySelectorAll('.flash').forEach(f => f.remove());
        }, 5000);

        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {
            {% if results %}
            initializeGradeChart();
            {% endif %}
        });

        function initializeGradeChart() {
            // Grade color mapping
            const gradeColors = {
                'A': '#10b981', // Green
                'B': '#3b82f6', // Blue
                'C': '#8b5cf6', // Purple
                'D': '#f59e0b', // Yellow
                'E': '#ec4899', // Pink/Magenta
                'F': '#ef4444'  // Red
            };

            const gradeLabels = [{% for r in results %}'{{ r.grade }}',{% endfor %}];
            const gradeCounts = {};
            gradeLabels.forEach(function(g){
                gradeCounts[g] = (gradeCounts[g] || 0) + 1;
            });
            
            // Sort grades in order A, B, C, D, E, F
            const sortedGrades = ['A', 'B', 'C', 'D', 'E', 'F'].filter(grade => gradeCounts[grade]);
            const labels = sortedGrades;
            const data = sortedGrades.map(grade => gradeCounts[grade]);
            const backgroundColors = sortedGrades.map(grade => gradeColors[grade]);
            
            const ctx = document.getElementById('gradeChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors,
                        borderWidth: 2,
                        borderColor: '#1f2937'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    size: 11,
                                },
                                padding: 10,
                                usePointStyle: true,
                            }
                        }
                    },
                    cutout: '55%'
                }
            });
        }

        // Table sorting functionality
        function sortTable(columnIndex) {
            // Implementation would be similar to original but optimized for mobile
            showNotification('Sorting feature would be implemented here', 'info');
        }

        // Update items per page
        function updatePerPage(value) {
            const url = new URL(window.location.href);
            url.searchParams.set('per_page', value);
            url.searchParams.set('page', 1);
            window.location.href = url.toString();
        }

        // PDF Generation
        async function downloadResultsPDF() {
            showNotification('Generating PDF...', 'info');
            // Implementation would be similar to original
            setTimeout(() => {
                showNotification('PDF downloaded successfully!', 'success');
            }, 1500);
        }

        function printResults() {
            window.print();
        }

        // Utility functions
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 left-4 px-4 py-3 rounded-xl shadow-lg z-50 transform transition-all duration-300 ${
                type === 'success' ? 'bg-green-600 text-white' :
                type === 'error' ? 'bg-red-600 text-white' :
                'bg-blue-600 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info'} mr-3"></i>
                    <span class="text-sm">${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Quick action handlers
        function viewAcademicCalendar() {
            showNotification('Academic calendar feature coming soon!', 'info');
        }

        function viewCourseMaterials() {
            showNotification('Course materials feature coming soon!', 'info');
        }

        function contactAdvisor() {
            showNotification('Contact advisor feature coming soon!', 'info');
        }

        // Photo options function
        function openPhotoOptions() {
            showNotification('Profile photo options would appear here', 'info');
        }

        // Change password modal function
        function openChangePasswordModal() {
            showNotification('Change password modal would appear here', 'info');
        }
    </script>
</body>
</html>