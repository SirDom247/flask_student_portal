{% extends "base.html" %}
{% block title %}Register{% endblock %}

{% block content %}
<div class="max-w-md mx-auto mt-20 bg-white p-8 rounded-xl shadow-lg">
    <h2 class="text-2xl font-bold mb-6 text-center">Register</h2>
    <form method="POST" class="space-y-4">

        <!-- First Name -->
        <input type="text" name="first_name" placeholder="First Name" required
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"/>

        <!-- Last Name -->
        <input type="text" name="last_name" placeholder="Last Name" required
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"/>

        <!-- Other Names -->
        <input type="text" name="other_names" placeholder="Other Names (Optional)"
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"/>

        <!-- Username -->
        <input type="text" name="username" placeholder="Username" required
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"/>

        <!-- Email -->
        <input type="email" name="email" placeholder="Email" required
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"/>

        <!-- Password -->
        <div class="relative">
            <input type="password" id="password" name="password" placeholder="Password" required
                   class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 pr-10"/>
            <button type="button" onclick="togglePassword('password', this)"
                    class="absolute right-2 top-2 text-gray-600">üëÅÔ∏è</button>
        </div>

        <!-- Confirm Password -->
        <div class="relative">
            <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm Password" required
                   class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 pr-10"/>
            <button type="button" onclick="togglePassword('confirm_password', this)"
                    class="absolute right-2 top-2 text-gray-600">üëÅÔ∏è</button>
        </div>

        <!-- Role Selection -->
        <select name="role" id="role" required
                class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400">
            <option value="">Select Role</option>
            <option value="student">Student</option>
            <option value="officer">Exam Officer</option>
        </select>

        <!-- Matric Number (only for students) -->
        <input type="text" name="matric_no" id="matric_no" placeholder="Matric No (students only)"
               class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"
               style="display:none;"/>

        <!-- Submit -->
        <button type="submit" class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700 transition">
            Register
        </button>
    </form>

    <p class="mt-4 text-sm text-gray-600 text-center">
        Already have an account? <a href="{{ url_for('login') }}" class="text-indigo-600">Login</a>
    </p>
</div>

<script>
    // Toggle password visibility
    function togglePassword(id, btn) {
        const input = document.getElementById(id);
        if (input.type === "password") {
            input.type = "text";
            btn.textContent = "üôà";
        } else {
            input.type = "password";
            btn.textContent = "üëÅÔ∏è";
        }
    }

    // Confirm password validation
    const form = document.querySelector('form');
    form.addEventListener('submit', function(event) {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        if (password !== confirmPassword) {
            alert("Passwords do not match!");
            event.preventDefault();
        }
    });

    // Show matric number only if role = student
    const roleSelect = document.getElementById('role');
    const matricField = document.getElementById('matric_no');

    roleSelect.addEventListener('change', function () {
        if (this.value === 'student') {
            matricField.style.display = "block";
            matricField.required = true;
        } else {
            matricField.style.display = "none";
            matricField.required = false;
        }
    });
</script>
{% endblock %}
